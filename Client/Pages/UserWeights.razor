@page "/userweights"
@using Radzen.Blazor

<PageTitle>Weights</PageTitle>

<h1>Weights</h1>
<label for="weight">Weight:</label>
<input id="weight" type="number" @bind="newWeight" />

<label for="weightDate">Date:</label>
<input id="weightDate" type="date" @bind="newWeightDate" />
<label for="weight">Weight:</label>
<button @onclick="() => AddWeight() ">Add</button>

@if (User == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <table class="table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Weight</th>
                <th></th>
            </tr>
        </thead>

        @foreach (var weight in User.UserWeights)
        {
            <tbody>
                <tr>
                    @if (editingWeightId == weight.UserWeightId)
                    {
                        <td><input type="date" @bind="@editingWeightDate" /></td>
                        <td><input type="number" @bind="@editingWeight" /></td>
                        <td>
                            <button @onclick="() => Save(weight.UserWeightId)">Save</button>
                            <button @onclick="() => Cancel()">Cancel</button>
                        </td>
                    }
                    else
                    {
                        <td>@weight.WeightDate</td>
                        <td>@weight.Weight</td>
                        <td>
                            <button @onclick="() => Edit(weight.UserWeightId)">Edit</button>
                            <button @onclick="() => Delete(weight.UserWeightId)">Delete</button>
                        </td>
                    }
                </tr>
            </tbody>
        }
    </table>


    <h2>Weight Graph</h2>
    <RadzenChart>
        <RadzenLegend />
        <RadzenCategoryAxis>
            <RadzenAxisTitle Text="Date" />
        </RadzenCategoryAxis>
        <RadzenValueAxis>
            <RadzenAxisTitle Text="Weight" />
            <RadzenGridLines Visible="true" />
        </RadzenValueAxis>
        <RadzenLineSeries Data="@User.UserWeights.OrderByDescending(w => w.WeightDate).Take(7)"
                      CategoryProperty="WeightDate"
                      ValueProperty="Weight"
                      Title="Weight"
                      Stroke="red">
            <RadzenMarkers MarkerType="MarkerType.Circle" />
            <RadzenSeriesDataLabels Visible="true" />
        </RadzenLineSeries>
    </RadzenChart>
}


